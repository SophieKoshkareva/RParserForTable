weight <- new("Weight")
FindErrors(weight)
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
rm(list = ls())
require(xlsx)
source("File.R")
file <- new("File")
file <- Open(file)
source("Error.R")
globalMissing <- character()
globalMisprint <- character()
globalOutlier <- character()
globalUnsolvedMisprint <- character()
source("Column.R")
source("MissingValue.R")
missingValue <- new("MissingValue")
source("Misprint.R")
misprint <- new("Misprint")
source("UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("Outlier.R")
outlier <- new("Outlier")
source("Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("Age.R")
age <- new("Age")
FindErrors(age)
source("Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
#install.packages("xlsx")
require(xlsx)
source("File.R")
file <- new("File")
file <- Open(file)
source("Error.R")
globalMissing <- character()
globalMisprint <- character()
globalOutlier <- character()
globalUnsolvedMisprint <- character()
source("Column.R")
source("MissingValue.R")
missingValue <- new("MissingValue")
source("Misprint.R")
misprint <- new("Misprint")
source("UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("Outlier.R")
outlier <- new("Outlier")
source("Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("Age.R")
age <- new("Age")
FindErrors(age)
source("Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
Error <- setClass("Error",
slots = c(indices = "character",
style = "character",
title = "character",
col_index_legend = "numeric")
)
setGeneric(name = "SetColor",
def = function(theObject, file)
{
standardGeneric("SetColor")
}
)
setMethod(f = "SetColor",
signature = "Error",
definition = function(theObject, file)
{
print("Coloring...")
MISSING_VALUE_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "gray70") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
MISPRINT_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "gold1") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
UNSOLVED_MISPRINT_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "darkorange") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
OUTLIERS_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "firebrick1") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
style <- switch(theObject@style,
"missing_value"= MISSING_VALUE_STYLE,
"misprint"= MISPRINT_STYLE,
"unsolved_misprint"= UNSOLVED_MISPRINT_STYLE,
"outlier"= OUTLIERS_STYLE)
# errorFont <- Font(file@wb, theObject@style["Font"])
# errorFill <- Fill(theObject@style["Fill"])
# errorBorder <- Border(theObject@style["Border"])
# errorStyle <- CellStyle(file@wb, font = errorFont, fill = errorFill, border = errorBorder)
rows <- getRows(file@sheet, rowIndex = 1:nrow(file@table_out) + file@row_header + file@row_table_legend)
cells <- getCells(rows, colIndex = 1:ncol(file@table_out))
lapply(names(cells[theObject@indices]), function(i) setCellStyle(cells[[i]], style))
AddTableLegend(theObject, style, file)
#return(file)
}
)
setGeneric(name = "AddTableLegend",
def = function(theObject, style, file)
{
standardGeneric("AddTableLegend")
}
)
setMethod(f = "AddTableLegend",
signature = "Error",
definition = function(theObject, style, file)
{
rows <- getRows(file@sheet,rowIndex = 1)
sheetTitle <- createCell(rows, theObject@col_index_legend)
setCellValue(sheetTitle[[1,1]], theObject@title)
setCellStyle(sheetTitle[[1,1]], style)
return(theObject)
}
)
setGeneric(name = "PrintReport",
def = function(theObject, path_report, row_index, col_index)
{
standardGeneric("PrintReport")
}
)
setMethod(f = "PrintReport",
signature = "Error",
definition = function(theObject, path_report, row_index, col_index)
{
cat(c(class(theObject)[1], "in", "row", row_index, "column", col_index, "\n"), file = path_report, append = T)
#cat(c(class(theObject)[1], " coordinates are: ", paste(row_index, col_index, sep = "."), "\n"), file = path_report, append = TRUE)
}
)
#install.packages("xlsx")
require(xlsx)
source("File.R")
file <- new("File")
file <- Open(file)
source("Error.R")
# globalMissing <- character()
# globalMisprint <- character()
# globalOutlier <- character()
# globalUnsolvedMisprint <- character()
source("Column.R")
source("MissingValue.R")
missingValue <- new("MissingValue")
source("Misprint.R")
misprint <- new("Misprint")
source("UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("Outlier.R")
outlier <- new("Outlier")
source("Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("Age.R")
age <- new("Age")
FindErrors(age)
source("Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
Error <- setClass("Error",
slots = c(indices = "character",
style = "character",
title = "character",
col_index_legend = "numeric")
)
setGeneric(name = "SetColor",
def = function(theObject, file)
{
standardGeneric("SetColor")
}
)
setMethod(f = "SetColor",
signature = "Error",
definition = function(theObject, file)
{
print("Coloring...")
MISSING_VALUE_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "gray70") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
MISPRINT_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "gold1") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
UNSOLVED_MISPRINT_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "darkorange") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
OUTLIERS_STYLE <- CellStyle(file@wb) +
Font(file@wb, isItalic = TRUE) +
Fill(foregroundColor = "firebrick1") +
Border(position = c("BOTTOM", "LEFT", "TOP", "RIGHT"))
style <- switch(theObject@style,
"missing_value"= MISSING_VALUE_STYLE,
"misprint"= MISPRINT_STYLE,
"unsolved_misprint"= UNSOLVED_MISPRINT_STYLE,
"outlier"= OUTLIERS_STYLE)
# errorFont <- Font(file@wb, theObject@style["Font"])
# errorFill <- Fill(theObject@style["Fill"])
# errorBorder <- Border(theObject@style["Border"])
# errorStyle <- CellStyle(file@wb, font = errorFont, fill = errorFill, border = errorBorder)
rows <- getRows(file@sheet, rowIndex = 1:nrow(file@table_out) + file@row_header + file@row_table_legend)
cells <- getCells(rows, colIndex = 1:ncol(file@table_out))
lapply(names(cells[theObject@indices]), function(i) setCellStyle(cells[[i]], style))
AddTableLegend(theObject, style, file)
return(file)
}
)
setGeneric(name = "AddTableLegend",
def = function(theObject, style, file)
{
standardGeneric("AddTableLegend")
}
)
setMethod(f = "AddTableLegend",
signature = "Error",
definition = function(theObject, style, file)
{
rows <- getRows(file@sheet,rowIndex = 1)
sheetTitle <- createCell(rows, theObject@col_index_legend)
setCellValue(sheetTitle[[1,1]], theObject@title)
setCellStyle(sheetTitle[[1,1]], style)
return(theObject)
}
)
setGeneric(name = "PrintReport",
def = function(theObject, path_report, row_index, col_index)
{
standardGeneric("PrintReport")
}
)
setMethod(f = "PrintReport",
signature = "Error",
definition = function(theObject, path_report, row_index, col_index)
{
cat(c(class(theObject)[1], "in", "row", row_index, "column", col_index, "\n"), file = path_report, append = T)
#cat(c(class(theObject)[1], " coordinates are: ", paste(row_index, col_index, sep = "."), "\n"), file = path_report, append = TRUE)
}
)
#install.packages("xlsx")
require(xlsx)
source("File.R")
file <- new("File")
file <- Open(file)
source("Error.R")
# globalMissing <- character()
# globalMisprint <- character()
# globalOutlier <- character()
# globalUnsolvedMisprint <- character()
source("Column.R")
source("MissingValue.R")
missingValue <- new("MissingValue")
source("Misprint.R")
misprint <- new("Misprint")
source("UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("Outlier.R")
outlier <- new("Outlier")
source("Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("Age.R")
age <- new("Age")
FindErrors(age)
source("Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
#install.packages("xlsx")
require(xlsx)
source("File.R")
file <- new("File")
file <- Open(file)
source("Error.R")
# globalMissing <- character()
# globalMisprint <- character()
# globalOutlier <- character()
# globalUnsolvedMisprint <- character()
source("Column.R")
source("MissingValue.R")
missingValue <- new("MissingValue")
source("Misprint.R")
misprint <- new("Misprint")
source("UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("Outlier.R")
outlier <- new("Outlier")
source("Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("Age.R")
age <- new("Age")
FindErrors(age)
source("Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
#install.packages("xlsx")
require(xlsx)
source("File.R")
file <- new("File")
file <- Open(file)
source("Error.R")
# globalMissing <- character()
# globalMisprint <- character()
# globalOutlier <- character()
# globalUnsolvedMisprint <- character()
source("Column.R")
source("MissingValue.R")
missingValue <- new("MissingValue")
source("Misprint.R")
misprint <- new("Misprint")
source("UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("Outlier.R")
outlier <- new("Outlier")
source("Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("Age.R")
age <- new("Age")
FindErrors(age)
source("Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
#install.packages("xlsx")
require(xlsx)
source("File.R")
file <- new("File")
file <- Open(file)
source("Error.R")
# globalMissing <- character()
# globalMisprint <- character()
# globalOutlier <- character()
# globalUnsolvedMisprint <- character()
source("Column.R")
source("MissingValue.R")
missingValue <- new("MissingValue")
source("Misprint.R")
misprint <- new("Misprint")
source("UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("Outlier.R")
outlier <- new("Outlier")
source("Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("Age.R")
age <- new("Age")
FindErrors(age)
source("Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
#install.packages("xlsx")
require(xlsx)
source("D:/Diploma/r_project/File.R")
file <- new("File")
file <- Open(file)
# globalMissing <- character()
# globalMisprint <- character()
# globalOutlier <- character()
# globalUnsolvedMisprint <- character()
source("D:/Diploma/r_project/Error.R")
source("D:/Diploma/r_project/MissingValue.R")
missingValue <- new("MissingValue")
source("D:/Diploma/r_project/Misprint.R")
misprint <- new("Misprint")
source("D:/Diploma/r_project/UnsolvedMisprint.R")
unsolvedMisprint <- new("UnsolvedMisprint")
source("D:/Diploma/r_project/Outlier.R")
outlier <- new("Outlier")
source("D:/Diploma/r_project/Column.R")
source("D:/Diploma/r_project/Sex.R")
sex <- new("Sex")
FindErrors(sex)
source("D:/Diploma/r_project/Age.R")
age <- new("Age")
FindErrors(age)
source("D:/Diploma/r_project/Weight.R")
weight <- new("Weight")
FindErrors(weight)
source("D:/Diploma/r_project/Diabetes.R")
diabetes <- new("Diabetes")
FindErrors(diabetes)
#other columns
file <- CreateExcelWB(file)
#missingValue@indices <- globalMissing
SetColor(missingValue, file)
#misprint@indices <- globalMisprint
SetColor(misprint, file)
#unsolvedMisprint@indices <- globalUnsolvedMisprint
SetColor(unsolvedMisprint, file)
#outlier@indices <- globalOutlier
SetColor(outlier, file)
file <- SaveExcelWB(file)
setwd("D:/Diploma/r_project")
